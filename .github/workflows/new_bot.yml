name: DevShot Bot V2

on:
  schedule:
    - cron: '0 23 * * *' # ë§¤ì¼ ì•„ì¹¨ 8ì‹œ
  workflow_dispatch: # ìˆ˜ë™ ì‹¤í–‰ ë²„íŠ¼

jobs:
  run-scraper:
    runs-on: ubuntu-latest
    
    permissions:
      contents: write

    steps:
    - name: ì½”ë“œ ë‚´ë ¤ë°›ê¸°
      uses: actions/checkout@v4

    - name: íŒŒì´ì¬ ì„¤ì •
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'

    - name: ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°•ì œ ì„¤ì¹˜ (íŒŒì¼ ì•ˆ ì½ìŒ)
      run: |
        python -m pip install --upgrade pip
        pip install google-generativeai feedparser requests beautifulsoup4 python-dotenv

    - name: ë´‡ ì‹¤í–‰
      env:
        GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        DISCORD_WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
      run: |
        python app.py

    - name: ì¥ë¶€ ì—…ë°ì´íŠ¸
      run: |
        git config --global user.name "DevShot Bot"
        git config --global user.email "bot@noreply.github.com"
        git add sent_logs.json
        git commit -m "ğŸ“ Log update" || exit 0
        git push